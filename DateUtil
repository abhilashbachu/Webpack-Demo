package com.example.demo;

import java.text.MessageFormat;
import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;

/**
 * @author abhilash.bachu
 *
 */
class DateUtils {

    /**Gets filename with date appended to placeholder
     * @param date-date to append to file
     * @param fileName-name of the files to pass
     * @param dateSeperator
     * @return
     */
    public static String getFileNameFromDate(final LocalDate date, final String fileName, final String dateSeperator) {
        String[] dateArray = date.toString().split("-");
        String dateToAppend = dateArray[0] + dateSeperator + dateArray[1] + dateSeperator + dateArray[2];
        return MessageFormat.format(fileName, dateToAppend);
    };
    
    /**Gets the filenames for current last month
     * @param fileName
     * @param dateSeperator
     * @return
     */
    public static List<String> getFileNamesForCurrentLastMonth(final String fileName, final String dateSeperator) {
        LocalDate previousMonthDate = LocalDate.now().minusMonths(1);
        return getFileNamesForGivenMonthByDate(previousMonthDate, fileName, dateSeperator);
    };
    
    /**Gets the filenames
     * @param firstDate
     * @param lastDate
     * @param fileName
     * @param dateSeperator
     * @return
     */
    public static List<String> getFileNames(final LocalDate firstDate, final LocalDate lastDate, final String fileName, String dateSeperator ) {
        List<String> fileNames = new ArrayList<>();
        for (LocalDate date = firstDate; (date.isBefore(lastDate) || date.isEqual(lastDate)); date = date.plusDays(1)) {
             fileNames.add(getFileNameFromDate(date, fileName, dateSeperator));
         }
         return fileNames;
    };
 
    /** Gets the first day of previous month of given date
     * @param date
     * @return
     */
    public static LocalDate firstDayOfPreviousMonth(final LocalDate date) {
        return date.minusMonths(1).withDayOfMonth(1);
    };
    
    
    /** Gets the last day of previous month of given date
     * @param date
     * @return
     */
    public static LocalDate lastDayOfPreviousMonth(final LocalDate date) {
        return date.withDayOfMonth(1).minusDays(1);
    };
    
    
    /**Gets the first day of month of given date
     * @param date
     * @return
     */
    public static LocalDate getFirstDayOfGivenMonth(final LocalDate date) {
        return date.withDayOfMonth(1);
    }

    /** Gets the last day of month of a given date
     * @param date
     * @return
     */
    public static LocalDate getLastDateofGivenMonth(final LocalDate date){
       return date.withDayOfMonth(date.lengthOfMonth());
    };
    
    /**Gets the file names for given Month by taking an date of that Month
     * @param date
     * @param fileName
     * @param dateSeperator
     * @return
     */
    public static List<String> getFileNamesForGivenMonthByDate(final LocalDate date, final String fileName, final String dateSeperator) {
       LocalDate firstDate = getFirstDayOfGivenMonth(date);
       LocalDate lastDate = getLastDateofGivenMonth(date);
       return getFileNames(firstDate, lastDate, fileName, dateSeperator);
    };
    

    /**Gets the fileNames for currentMonth
     * @param fileName
     * @param dateSeperator
     * @return
     */
    public static List<String> getFileNamesForCurrentMonth(final String fileName, final String dateSeperator) {
           LocalDate todaysDate = LocalDate.now();
          return getFileNamesForGivenMonthByDate(todaysDate, fileName, dateSeperator);
    }
    
    /** Gets the fileNames between given days.
     * @param firstDate
     * @param lastDate
     * @param fileName
     * @param seperator
     * @return
     */
    public static List<String> getFilesNamesBetweenGivenDays(final LocalDate firstDate, final LocalDate lastDate, final String fileName, final String seperator) {
       return getFileNames(firstDate, lastDate, fileName, seperator);
    }
    
    /** Gets the fileNames Between given days by taking date strings
     * @param firstDate
     * @param lastDate
     * @param fileName
     * @param seperator
     * @return
     */
    public static List<String> getFilesNamesBetweenGivenDays(final String firstDate, final String lastDate, final String fileName, final String seperator) {
        LocalDate first = LocalDate.parse(firstDate);
        LocalDate last = LocalDate.parse(lastDate);
        return getFileNames(first, last, fileName, seperator);
     }
}
